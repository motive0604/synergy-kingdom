assert(getprop("ro.product.device") == "supersonic" || getprop("ro.build.product") == "supersonic" || getprop("ro.product.board") == "supersonic");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("   ______                                    ");
ui_print("  / _____)                                   ");
ui_print(" ( (____  _   _ ____  _____  ____ ____ _   _ ");
ui_print("  \____ \| | | |  _ \| ___ |/ ___) _  | | | |");
ui_print("  _____) ) |_| | | | | ____| |  ( (_| | |_| |");
ui_print(" (______/ \__  |_| |_|_____)_|   \___ |\__  |");
ui_print("         (____/                 (_____(____/ ");
ui_print("   _  ___                 _                 ");
ui_print("  | |/ (_)               | |                ");
ui_print("  | ' / _ _ __   __ _  __| | ___  _ __ ___  ");
ui_print("  |  < | | '_ \ / _` |/ _` |/ _ \| '_ ` _ \ ");
ui_print("  | . \| | | | | (_| | (_| | (_) | | | | | |");
ui_print("  |_|\_\_|_| |_|\__, |\__,_|\___/|_| |_| |_|");
ui_print("                 __/ |                      ");
ui_print("                |___/                       ");
ui_print("");
ui_print("                     NIGHTLY");
ui_print("                  Developed by:");
ui_print("                      Virus");
ui_print("                      TrevE");
ui_print("                    Damageless");
ui_print("                        &");
ui_print("                     Ziggy471");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
ui_print("");
show_progress(1.000000, 0);

unmount("/system");
unmount("/data");

format("MTD", "system");
run_program("/sbin/tune2fs", "-m", "0", "/dev/block/mtdblock4 ");


set_progress(0.100000);
run_program("/sbin/busybox", "mkdir", "/sd-ext");
mount("MTD", "sdext", "/sd-ext");
mount("MTD", "system", "/system");
mount("MTD", "userdata", "/data");
run_program("/sbin/busybox", "mount", "-t", "auto", "/dev/block/mmcblk0p2", "/sd-ext");

delete_recursive("/cache");
delete_recursive("/data/dalvik-cache");
delete_recursive("/sd-ext/dalvik-cache");
delete_recursive("/data/boot-cache");
delete_recursive("/data/app-s");
delete_recursive("/data/app_s");
delete_recursive("/data/system.app");
delete_recursive("/data/system.app");
delete_recursive("/data/synergy");
delete_recursive("/data/data/com.android.browser/cache");
delete_recursive("/data/data/com.google.android.street/cache");
delete_recursive("/data/data/com.android.vending/cache");
delete_recursive("/data/data/com.google.android.apps.maps/cache");
delete_recursive("/data/data/com.google.android.gm/cache");
delete_recursive("/data/data/com.google.android.voicesearch/cache");


set_progress(0.250000);

package_extract_dir("system", "/system");
set_progress(0.400000);

package_extract_dir("data", "/data");
set_progress(0.600000);

set_perm_recursive(1000, 1000, 0771, 0644, "/data/app");
set_perm_recursive(1000, 1000, 0777, 0777, "/data/data/com.fede.launcher");
package_extract_dir("app_s", "/data/app_s");
mount("MTD", "system", "/system");

symlink("dumpstate", "/system/bin/bugreport");
symlink("dumpstate", "/system/bin/dumpcrash");
symlink("toolbox", "/system/bin/cat", "/system/bin/chmod", "/system/bin/chown",
        "/system/bin/chownto", "/system/bin/ionice", "/system/bin/nandread",
        "/system/bin/cmp", "/system/bin/date", "/system/bin/dd",
        "/system/bin/df", "/system/bin/dmesg", "/system/bin/getevent",
        "/system/bin/getprop", "/system/bin/hd", "/system/bin/id",
        "/system/bin/ifconfig", "/system/bin/iftop", "/system/bin/insmod",
        "/system/bin/ioctl", "/system/bin/kill", "/system/bin/ln",
        "/system/bin/log", "/system/bin/ls", "/system/bin/lsmod",
        "/system/bin/mkdir", "/system/bin/mount", "/system/bin/mv",
        "/system/bin/netstat", "/system/bin/newfs_msdos", "/system/bin/notify",
        "/system/bin/printenv", "/system/bin/ps", "/system/bin/renice",
        "/system/bin/rm", "/system/bin/rmdir", "/system/bin/rmmod",
        "/system/bin/route", "/system/bin/schedtop", "/system/bin/sendevent",
        "/system/bin/setconsole", "/system/bin/setprop", "/system/bin/sleep",
        "/system/bin/smd", "/system/bin/start", "/system/bin/stop",
        "/system/bin/sync", "/system/bin/top", "/system/bin/umount",
        "/system/bin/vmstat", "/system/bin/watchprops", "/system/bin/wipe");

package_extract_dir("cache", "/cache");			
package_extract_file("checkforrosieinstall.sh", "/cache/checkforrosieinstall.sh");
set_perm(0, 0, 0777, "/cache/checkforrosieinstall.sh");
run_program("/cache/checkforrosieinstall.sh");

set_perm_recursive(0, 0, 0755, 0644, "/system");
set_perm_recursive(0, 2000, 0755, 0755, "/system/bin");

set_perm(0, 3003, 06755, "/system/bin/ip");
set_perm(0, 3003, 02750, "/system/bin/netcfg");
set_perm(0, 3004, 02755, "/system/bin/ping");
set_perm(0, 2000, 06750, "/system/bin/run-as");
set_perm(1000, 1000, 0755, "/system/bin/bash");
set_perm(1000, 1000, 0755, "/system/bin/sysro");
set_perm(1000, 1000, 0755, "/system/bin/sysrw");
set_perm(0, 0, 0755, 0555, "/system/bin/swap"); 
set_perm(0, 0, 04755, "/system/bin/sh");
set_perm(0, 0, 06755, "/system/bin/su");
set_perm(1000, 1000, 0755, "/system/bin/nano");
set_perm(0, 0, 0777, "/system/bin/zipalign");
set_perm_recursive(1002, 1002, 0755, 0440, "/system/etc/bluetooth");
set_perm(0, 0, 0755, "/system/etc/bluetooth");
set_perm(1000, 1000, 0640, "/system/etc/bluetooth/auto_pairing.conf");
set_perm(3002, 3002, 0444, "/system/etc/bluetooth/blacklist.conf");
set_perm(1002, 1002, 0440, "/system/etc/dbus.conf");
set_perm(1014, 2000, 0550, "/system/etc/dhcpcd/dhcpcd-run-hooks");
set_perm(0, 2000, 0550, "/system/etc/init.goldfish.sh");

set_perm_recursive(0, 0, 0755, 0555, "/system/etc/ppp");
set_perm_recursive(0, 2000, 0755, 0755, "/system/xbin");

set_perm_recursive(0, 2000, 0755, 0750, "/system/etc/init.d");
set_perm(0, 0, 0755, "/system/etc/init.d");

delete("/system/bin/su");
symlink("/system/xbin/su", "/system/bin/su");
set_perm(0, 0, 06755, "/system/xbin/su");
set_perm(0, 0, 04755, "/system/xbin/busybox");

set_perm_recursive(0, 0, 0755, 0755, "/system/synergy/scripts");
run_program("/system/xbin/busybox","--install","-s","/system/xbin/bb");
run_program("/system/xbin/busybox","--install","-s","/system/bin");
symlink("/system/bin/bash", "/system/bin/sh");

package_extract_file("synergy-setup_rom", "/tmp/synergy-setup_rom");
package_extract_file("fixrmk.sh", "/tmp/fixrmk.sh");
set_perm(0, 0, 0777, "/tmp/synergy-setup_rom");
set_perm(0, 0, 0777, "/tmp/fixrmk.sh");
run_program("/tmp/fixrmk.sh");
run_program("/tmp/synergy-setup_rom");

delete_recursive("/sdcard/VirusROM");
delete_recursive("/sdcard/synergy");
delete_recursive("/sdcard/SynergyROM/app.rom");
package_extract_dir("sdcard", "/sdcard");

package_extract_file("cleanup", "/tmp/cleanup");
package_extract_file("MS", "/tmp/MS");
set_perm(0, 0, 0777, "/tmp/cleanup");
set_perm(0, 0, 0777, "/tmp/MS");
run_program("/tmp/MS");
<<<<<<< .mine
run_program("/system/bin/fix_permissions");
run_program("/tmp/cleanup");
=======
>>>>>>> .r120

set_progress(0.700000);

run_program("/system/bin/fix_permissions");

set_progress(0.900000);

assert(package_extract_file("boot.img", "/tmp/boot.img"),
       write_raw_image("/tmp/boot.img", "boot"),
       delete("/tmp/boot.img"));
	   
set_progress(1.000000);
show_progress(1.000000, 0);   
unmount("/system");
unmount("/data");
